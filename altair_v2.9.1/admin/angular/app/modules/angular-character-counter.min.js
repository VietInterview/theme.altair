!function($){"use strict";$.fn.extend({counter:function(options){var defaults={type:"char",count:"down",goal:140,text:!0,target:!1,append:!0,translation:"",msg:"",container_class:""},$countObj="",countIndex="",noLimit=!1,options=$.extend({},defaults,options),methods={init:function($obj){var objID=$obj.attr("id"),counterID=objID+"_count";methods.isLimitless(),$countObj=$("<span id="+counterID+"/>");var counterDiv=$("<div/>").attr("id",objID+"_counter").append($countObj).append(" "+methods.setMsg());options.container_class&&options.container_class.length&&counterDiv.addClass(options.container_class),options.target&&$(options.target).length?options.append?$(options.target).append(counterDiv):$(options.target).prepend(counterDiv):options.append?counterDiv.insertAfter($obj):counterDiv.insertBefore($obj),methods.bind($obj)},bind:function($obj){$obj.bind("keypress.counter keydown.counter keyup.counter blur.counter focus.counter change.counter paste.counter",methods.updateCounter),$obj.bind("keydown.counter",methods.doStopTyping),$obj.trigger("keydown")},isLimitless:function(){if("sky"===options.goal)return options.count="up",noLimit=!0},setMsg:function(){if(""!==options.msg)return options.msg;if(options.text===!1)return"";if(noLimit)return""!==options.msg?options.msg:"";switch(this.text=options.translation||"character word left max",this.text=this.text.split(" "),this.chars="s ( )".split(" "),this.msg=null,options.type){case"char":options.count===defaults.count&&options.text?this.msg=this.text[0]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.text[2]:"up"===options.count&&options.text&&(this.msg=this.text[0]+this.chars[0]+" "+this.chars[1]+options.goal+" "+this.text[3]+this.chars[2]);break;case"word":options.count===defaults.count&&options.text?this.msg=this.text[1]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.text[2]:"up"===options.count&&options.text&&(this.msg=this.text[1]+this.chars[1]+this.chars[0]+this.chars[2]+" "+this.chars[1]+options.goal+" "+this.text[3]+this.chars[2])}return this.msg},getWords:function(val){return""!==val?$.trim(val).replace(/\s+/g," ").split(" ").length:0},updateCounter:function(e){var $this=$(this);(countIndex<0||countIndex>options.goal)&&methods.passedGoal($this),options.type===defaults.type?options.count===defaults.count?(countIndex=options.goal-$this.val().length,countIndex<=0?$countObj.text("0"):$countObj.text(countIndex)):"up"===options.count&&(countIndex=$this.val().length,$countObj.text(countIndex)):"word"===options.type&&(options.count===defaults.count?(countIndex=methods.getWords($this.val()),countIndex<=options.goal?(countIndex=options.goal-countIndex,$countObj.text(countIndex)):$countObj.text("0")):"up"===options.count&&(countIndex=methods.getWords($this.val()),$countObj.text(countIndex)))},doStopTyping:function(e){var keys=[46,8,9,35,36,37,38,39,40,32];if(methods.isGoalReached(e)&&e.keyCode!==keys[0]&&e.keyCode!==keys[1]&&e.keyCode!==keys[2]&&e.keyCode!==keys[3]&&e.keyCode!==keys[4]&&e.keyCode!==keys[5]&&e.keyCode!==keys[6]&&e.keyCode!==keys[7]&&e.keyCode!==keys[8])return options.type!==defaults.type&&(e.keyCode!==keys[9]&&e.keyCode!==keys[1]&&options.type!=defaults.type)},isGoalReached:function(e,_goal){return!noLimit&&(options.count===defaults.count?(_goal=0,countIndex<=_goal):(_goal=options.goal,countIndex>=_goal))},wordStrip:function(numOfWords,text){var wordCount=text.replace(/\s+/g," ").split(" ").length;return text=$.trim(text),numOfWords<=0||numOfWords===wordCount?text:(text=$.trim(text).split(" "),text.splice(numOfWords,wordCount,""),$.trim(text.join(" ")))},passedGoal:function($obj){var userInput=$obj.val();"word"===options.type&&$obj.val(methods.wordStrip(options.goal,userInput)),"char"===options.type&&$obj.val(userInput.substring(0,options.goal)),"down"===options.type&&$countObj.val("0"),"up"===options.type&&$countObj.val(options.goal)}};return this.each(function(){methods.init($(this))})}})}(jQuery),angular.module("char-counter",[]).directive("charCounter",["$timeout",function($timeout){return{restrict:"A",link:function(scope,elem,attrs){var $this=$(elem),thisGoal=attrs.maxlength?attrs.maxlength:80;$timeout(function(){$this.counter({container_class:"text-count-wrapper",msg:" / "+thisGoal,goal:thisGoal,count:"up"}),$this.closest(".md-input-wrapper").length&&$this.closest(".md-input-wrapper").addClass("md-input-wrapper-count")})}}}]);