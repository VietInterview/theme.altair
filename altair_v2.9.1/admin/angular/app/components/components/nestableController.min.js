angular.module("altairApp").controller("nestableCtrl",["$scope","$rootScope","$state","utils",function($scope,$rootScope,$state,utils){function loop_nestable(obj,ul){$.each(obj,function(key,val){var content=$nestable.find("[data-id="+val.id+"]").html();if(val&&"object"==typeof val){var li=$("<li class='uk-nestable-item' data-id='"+val.id+"'>"+content+"</li>").appendTo(ul);if(val.children){var ul2=$("<ul>").appendTo(li);loop_nestable(val.children,ul2)}}else $("<li class='uk-nestable-item' data-id='"+val.id+"'>"+content+"</li>").appendTo(ul)})}var $nestable=$("#nestable");if($nestable.length){if(utils.lsTest()&&null!==localStorage.getItem("nestable_items")){var nestable_array=localStorage.getItem("nestable_items"),$nestable_cloned=$nestable.clone().empty();loop_nestable(JSON.parse(nestable_array),$nestable_cloned),$nestable.html($nestable_cloned.html()).after('<a class="md-btn" href="#" id="restore_nestable">Restore</a>'),$("body").on("click","#restore_nestable",function(){localStorage.removeItem("nestable_items"),$state.reload()})}UIkit.nestable($nestable,{});$nestable.on("change.uk.nestable",function(){var serialized_data=$nestable.data("nestable").serialize();utils.lsTest()&&(0!==localStorage.length&&localStorage.getItem("nestable_items")==JSON.stringify(serialized_data)||localStorage.setItem("nestable_items",JSON.stringify(serialized_data)),$("#restore_nestable").length||$nestable.after('<a class="md-btn" href="#" id="restore_nestable">Restore</a>'))})}}]);