!function(root,factory){"function"==typeof define&&define.amd?define(["angular"],factory):factory(angular)}(this,function(angular){function ckeditorDirective($parse){return{restrict:"A",require:["ckeditor","ngModel"],controller:["$scope","$element","$attrs","$parse","$q",ckeditorController],link:function(scope,element,attrs,ctrls){var controller=ctrls[0],ngModelController=ctrls[1];controller.ready().then(function(){["dataReady","change","blur","saveSnapshot"].forEach(function(event){controller.onCKEvent(event,function(){ngModelController.$setViewValue(controller.instance.getData()||"")})}),controller.instance.setReadOnly(!!attrs.readonly),attrs.$observe("readonly",function(readonly){controller.instance.setReadOnly(!!readonly)}),setImmediate(function(){$parse(attrs.ready)(scope)})}),ngModelController.$render=function(){controller.ready().then(function(){controller.instance.setData(ngModelController.$viewValue||"")})}}}}function ckeditorController($scope,$element,$attrs,$parse,$q){var instance,config=$parse($attrs.ckeditor)($scope)||{},editorElement=$element[0],readyDeferred=$q.defer();instance=editorElement.hasAttribute("contenteditable")&&"true"==editorElement.getAttribute("contenteditable").toLowerCase()?this.instance=CKEDITOR.inline(editorElement,config):this.instance=CKEDITOR.replace(editorElement,config),this.onCKEvent=function(event,listener){function asyncListener(){var args=arguments;setImmediate(function(){applyListener.apply(null,args)})}function applyListener(){var args=arguments;$scope.$apply(function(){listener.apply(null,args)})}return instance.on(event,asyncListener),function(){instance.removeListener(event,applyListener)}},this.onCKEvent("instanceReady",function(){readyDeferred.resolve(!0)}),this.ready=function(){return readyDeferred.promise},$scope.$on("$destroy",function(){readyDeferred.promise.then(function(){instance.destroy(!1)})})}angular.module("ckeditor",[]).directive("ckeditor",["$parse",ckeditorDirective]);var setImmediate=window&&window.setImmediate?window.setImmediate:function(fn){setTimeout(fn,0)}});